"0","# this is a function that creates plots"
"0","partner_mean_usd <- function(tbl, name){"
"0",""
"0","  tbl %>% "
"0","    filter(!is.na(new_beneficiaries) & !is.na(usd_per_hhd)) %>%"
"0","    filter(delivery_modality %in% c(""CBT/CVA"", ""Hybrid (In-kind & CBT/CVA)"")) %>%"
"0","    filter(activity_red == {{name}}) %>%"
"0","    mutate(households = ifelse(activity_red == ""food distribution"", "
"0","                                       beneficiaries, "
"0","                                       households)) %>% "
"0","    group_by(org_code) %>% "
"0","    summarise(total_value_usd = sum(total_value_usd),"
"0","              beneficiaries = sum(new_beneficiaries), "
"0","              households = sum(households)) %>% "
"0","    mutate(mean_usd = total_value_usd / households) %>% "
"0","    arrange(desc(beneficiaries)) %>%  "
"0","    top_n(7) %>% "
"0","    mutate(org_code = fct_reorder(org_code, beneficiaries)) %>% "
"0","    ggplot(aes(x = mean_usd, y = org_code, fill = beneficiaries)) + "
"0","    scale_x_continuous(labels = dollar_format(accuracy = 1)) + "
"0","    scale_fill_viridis(option = ""mako"", direction = -1, begin = 0.2, "
"0","                       labels = number_format(scale = 1 / 1000, suffix = ""K"", accuracy = 1)) +"
"0","    geom_col() +"
"0","    geom_text(aes(label = dollar(mean_usd)), size = 2, hjust = ""inward"") + "
"0","    theme(axis.text.y = element_text(size = 8)) +"
"0","  labs(x = ""Average USD value of package per transfer"", "
"0","       y = """") +"
"0","    theme(legend.title = element_text(size = 4),"
"0","          legend.text = element_text(size = 4.5), "
"0","          plot.title = element_text(size = 10),"
"0","          axis.title.x = element_text(size = 8))"
"0","}"
"0",""
"0","# pasting plots together using the patchwork package"
"0","fsc_se %>% partner_mean_usd(""food distribution"") +"
"0","  labs(title = ""Food distributions (per person)"") +"
"0","  "
"0","fsc_se %>% partner_mean_usd(""food_cash for work_assets"") + "
"0","  labs(title = ""Food/cash for work/assets (per hhd)"") + "
"0","  "
"0","fsc_se %>% partner_mean_usd(""multi-purpose cash transfer"") +"
"0","  labs(title = ""Multi-purpose cash transfer (per hhd)"") + "
"0","  "
"0","# commented out because there is no IGA in the northwest  "
"0","# fsc_se %>% partner_mean_usd(""IGA and small grants"") +"
"0","#   labs(title = ""IGA and small grants (per hhd)"") + "
"0","  "
"0","  # this is the overall plot title and subtitle "
"0","  plot_annotation(title = ""Cash transfer values of the top implementing partners (by beneficiaries reached)"", "
"0","                  subtitle = ""Faceted by activity"") + "
"0","  plot_layout(ncol = 2)"
"1","Selecting by mean_usd
"
"1","Selecting by mean_usd
"
"1","Selecting by mean_usd
"
