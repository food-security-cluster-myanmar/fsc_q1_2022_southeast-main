"0","# this df makes the labels"
"0","state_totals <- fsc_se %>% "
"0","  filter(!is.na(delivery_modality)) %>% "
"0","  group_by(state) %>% "
"0","  summarise(total = sum(new_beneficiaries)) %>% "
"0","  mutate(pc = 1, "
"0","         state = fct_reorder(state, total))"
"0",""
"0","fsc_se %>%  "
"0","  filter(!is.na(delivery_modality)) %>%  "
"0","   mutate(delivery_modality = case_when(str_detect(delivery_modality, ""Hybrid"") ~ ""Hybrid"", "
"0","                                       str_detect(delivery_modality, ""Service"") ~ ""Service delivery"", "
"0","                                       TRUE ~ delivery_modality)) %>%"
"0","  group_by(state, delivery_modality) %>% "
"0","  summarise(beneficiaries = sum(beneficiaries)) %>% "
"0","  group_by(state) %>% "
"0","  mutate(pc = beneficiaries / sum(beneficiaries),"
"0","         state = fct_reorder(state, beneficiaries)) %>% "
"0","  ggplot(aes(x = pc, y = fct_rev(state), fill = delivery_modality)) + "
"0","  geom_col() +"
"0","  scale_x_continuous(labels = percent, breaks = seq(0, 1, by = .2)) + "
"0","  geom_text(aes(y = state, x = pc + 0.125, label = comma(total, accuracy = 1), fill = NULL), "
"0","            data = state_totals, hjust = ""inward"", size = 2.5) +"
"0","  labs(x = ""% of total"", y = """", fill = """", "
"0","       title = ""Percentage of beneficiaries reached by delivery modalities"", "
"0","       subtitle = ""State beneficiary totals at the end of each bar"")"
"1","`summarise()` has grouped output by 'state'. You can override using the `.groups` argument.
"
