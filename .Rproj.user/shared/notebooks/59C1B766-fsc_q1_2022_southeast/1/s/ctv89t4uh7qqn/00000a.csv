"0","fsc_se %>% "
"0","  group_by(admin3_pcode_old) %>% "
"0","  summarise(beneficiaries = sum(new_beneficiaries),"
"0","            partners = n_distinct(org_code)) %>% "
"0","  right_join(pin, by = c(""admin3_pcode_old"" = ""admin3_pcode"")) %>% "
"0","  replace_na(list(beneficiaries = 0)) %>%"
"0","  mutate(reached_pc = beneficiaries / fs_targeted,"
"0","         reached_pc = ifelse(is.infinite(reached_pc), 1, reached_pc),"
"0","         reached_pc = round(reached_pc * 100, digits = 2), "
"0","         fs_targeted = round(fs_targeted, digits = 0),"
"0","         overreach = beneficiaries - fs_targeted) %>% "
"0","  arrange(desc(beneficiaries)) %>% "
"0","  select(state, township, target = fs_targeted, beneficiaries, overreach, `%_reached` = reached_pc, partners) %>% "
"0","  datatable(options = list(pageLength = 15, scrollX = TRUE), "
"0","            filter = list(position = ""top"", clear = FALSE),"
"0","            caption = htmltools::tags$caption(style = 'caption-side: top; "
"0","                                    text-align: center; "
"0","                                    color:black; font-size:120% ;',"
"0","                                    ""Reference table -- townships"")) %>% "
"0","  formatRound(c(""target"", ""beneficiaries"", ""overreach""), digits = 0) %>% "
"0","  formatStyle(0, target = ""row"", lineHeight = ""80%"", fontSize = ""80%"")"
